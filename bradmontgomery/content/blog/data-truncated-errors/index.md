---
date: '2009-05-06T15:03:00+00:00'
title: Data Truncated Errors
draft: false
tags:
- Python
- django
- mysql
- web
slug: data-truncated-errors
description: I recently ran into ...
markup: html
url: /blog/data-truncated-errors/
aliases:
- /blog/2009/05/06/data-truncated-errors/

---

I recently ran into some of the <b>Data truncated for column ...</b> errors in my django apps.  After a little digging, I've discovered that my particular problem lie in the structure of the underlying MySQL tables.  Particularly with <em>varchar</em> columns.  <br /><br />I have a model that contains a FileField:<br /><div class="highlight" ><pre><span style="color: #007020; font-weight: bold">class</span> <span style="color: #0e84b5; font-weight: bold">MyModel</span>(models<span style="color: #666666">.</span>Model):<br />    <span style="color: #007020">file</span> <span style="color: #666666">=</span> models<span style="color: #666666">.</span><span style="color: #007020">FileField</span>(upload_to<span style="color: #666666">=</span><span style="color: #4070a0">&quot;files/%Y/%m/</span><span style="color: #70a0d0; font-style: italic">%d</span><span style="color: #4070a0">&quot;</span>)<br /></pre></div><br /><br />Note that the MySQL table generated by this model will look something like the following:<br /><div class="highlight" ><pre>+-------------+--------------+------+-----+---------------------+----------------+<br />| Field       | Type         | Null | Key | Default             | Extra          |<br />+-------------+--------------+------+-----+---------------------+----------------+<br />| id          | int(11)      |      | PRI | NULL                | auto_increment |<br />| file        | varchar(100) |      |     |                     |                |<br />+-------------+--------------+------+-----+---------------------+----------------+<br /></pre></div><br /><br />See the <b>varchar(100)</b>!  If you're users are uploading files with long names (mine are!), this may not be enough!  Note that my model also has an <em>upload_to</em> that includes a year, month, and day.  That's already 17 characters...<br /><br />So when someone tries to upload a file named:<br /><pre>Who_Said_One_Hundred_Characters_Would_Ever_Be_Enough_For_A_REALLY_LONG_Filename_draft_one_.docx</pre><br /><br />It will get pre-pended with '/files/2009/05/06/', and what gets stored in your table?<br /><pre>files/2009/05/06/Who_Said_One_Hundred_Characters_Would_Ever_Be_Enough_For_A_REALLY_LONG_Filename_draft_one_.docx</pre><br /><br />That's 112 characters... and it won't work!<br /><br /><b>The solution?</b><br />You could alter your table so that the file column is a varchar(255)... which may help.  <br /><pre>alter table myapp_mymodel modify file varchar(255);</pre><br /><br />OR, use shorter filenames!<br /><br />Good Luck!<div class="blogger-post-footer"><img width='1' height='1' src='https://blogger.googleusercontent.com/tracker/4123748873183487963-3946931358470469763?l=bradmontgomery.blogspot.com' alt='' /></div>