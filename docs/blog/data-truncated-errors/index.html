<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width" />
    <title>Data Truncated Errors</title>
    
    <link rel="stylesheet" href="/static/simple.css-2.2.1/simple.min.css">
  </head>
  <body>
    <header>
      <nav>
        <a href="/">Home</a>
        <a href="/blog/">Blog</a>
        
        
        <a href="/tags/">About</a>
        <a href="/services/">Services</a>
        <a href="/contact/">Contact</a>k
      </nav>
      <h1>Data Truncated Errors</h1>
    </header>
    <main>
    
  <section>
  
<p>I recently ran into some of the <strong>Data truncated for column ...</strong> errors in my django apps. After a little digging, I've discovered that my particular problem lie in the structure of the underlying MySQL tables. Particularly with <em>varchar</em> columns.</p>
<p>I have a model that contains a FileField:</p>
<pre><code>class MyModel(models.Model):  
    file = models.FileField(upload_to=&quot;files/%Y/%m/%d&quot;)  

</code></pre>
<p>Note that the MySQL table generated by this model will look something like the following:</p>
<pre><code>+-------------+--------------+------+-----+---------------------+----------------+  
| Field       | Type         | Null | Key | Default             | Extra          |  
+-------------+--------------+------+-----+---------------------+----------------+  
| id          | int(11)      |      | PRI | NULL                | auto_increment |  
| file        | varchar(100) |      |     |                     |                |  
+-------------+--------------+------+-----+---------------------+----------------+  

</code></pre>
<p>See the <strong>varchar(100)</strong>! If you're users are uploading files with long names (mine are!), this may not be enough! Note that my model also has an <em>upload_to</em> that includes a year, month, and day. That's already 17 characters...</p>
<p>So when someone tries to upload a file named:</p>
<pre><code>Who_Said_One_Hundred_Characters_Would_Ever_Be_Enough_For_A_REALLY_LONG_Filename_draft_one_.docx
</code></pre>
<p>It will get pre-pended with '/files/2009/05/06/', and what gets stored in your table?</p>
<pre><code>files/2009/05/06/Who_Said_One_Hundred_Characters_Would_Ever_Be_Enough_For_A_REALLY_LONG_Filename_draft_one_.docx
</code></pre>
<p>That's 112 characters... and it won't work!</p>
<p><strong>The solution?</strong><br />
You could alter your table so that the file column is a varchar(255)... which may help.</p>
<pre><code>alter table myapp_mymodel modify file varchar(255);
</code></pre>
<p>OR, use shorter filenames!</p>
<p>Good Luck!<img src="https://blogger.googleusercontent.com/tracker/4123748873183487963-3946931358470469763?l=bradmontgomery.blogspot.com" alt="" /></p>

  </section>

    </main>
    <footer>
      All content copyright &copy; Brad Montgomery.
    </footer>
  </body>
</html>
